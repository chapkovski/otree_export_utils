{% extends "otree/BaseAdmin.html" %}
{% load staticfiles  %}
{% block title %}
list of assignments for the HIT {{current_hit_id}}
{% endblock %}

{% block content %}
<div class="panel panel-default">
    <div class="panel-body">
        <div class="btn-group">
            <button type="button" class="btn btn-success ">Expire HIT</button>
            <button type="button" class="btn btn-danger" id="hit-delete">Delete HIT</button>
            <button type="button" class="btn btn-info ">Change expiration date</button>
        </div>
    </div>
</div>


{% if assignments %}
<h3>Assignments</h3>
<table class="table">
    <thead>
    <tr>
        <th>Assignment ID</th>
        <th>Status</th>
        <th></th>
        <th>
            Worker ID
        </th>


    </tr>

    </thead>
    {% for assignment in assignments %}
    <tr>
        <td>{{assignment.AssignmentId|truncatechars:10}}</td>
        <td>{{assignment.AssignmentStatus}}</td>

        {% if assignment.AssignmentStatus == 'Submitted' %}
        <td>
            <form action="">
                <div class="btn-group">
                    <a href="{% url 'approve_assignment' assignment.AssignmentId %}" role='button'
                       class="btn btn-success btn-sm">Approve</a>
                    <a href="{% url 'reject_assignment' assignment.AssignmentId %}" role='button'
                       class="btn btn-danger btn-sm">Reject</a>
                </div>
            </form>
        </td>
        {% endif %}
        {% if assignment.AssignmentStatus == 'Rejected' %}
        <td>
            <button type="button" class="btn btn-success btn-sm">Re-accept</button>
        </td>
        {% endif %}
        <td>{{assignment.WorkerId}}</td>
        {% if assignment.AssignmentStatus == 'Approved' %}
        <td><a class="btn btn-default btn-sm  " role="button"
               href="{% url 'send_bonus' current_hit_id  assignment.AssignmentId assignment.WorkerId %}">Send bonus</a>
        </td>
        {% endif %}

        <td><a class="btn btn-default btn-sm " role="button"
               href="{% url 'send_message' current_hit_id  assignment.AssignmentId  assignment.WorkerId %}">Send
            message</a></td>

    </tr>
    {% endfor %}
</table>

{%endif%}

<a href="{% url 'hits_list' %}" class="btn btn-default btn-lg " role="button">Back</a>
{% endblock %}

{% block internal_styles %}
{{ block.super }}

{% endblock %}
{% block internal_scripts %}
{{ block.super }}
<script>
    var delete_hit_url = "{% url 'delete_hit' current_hit_id  %}";
</script>
<script src="{% static 'otree_export_utils/js/ajax_delete_hit.js' %}"></script>
<script src="{% static 'otree_export_utils/js/ajax_change_expiration_hit.js' %}"></script>
{% endblock %}
